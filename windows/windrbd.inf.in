;;;
;;; install/uninstall drbd engine driver
;;;

[Version]
signature   =   "$Windows NT$"
;; inf2cat complains if this is not specified:
Class       =   "Volume" ; Virtual storage driver (creates block devices)
Provider    =   "Linbit"
DriverVer   =   12/01/2013,0.2.0.0 ;Will get replaced by build magic
CatalogFile =   windrbd.cat

[DestinationDirs]
DefaultDestDir       = 12
DRBD.DriverFiles     = 12           ;%windir%\system32\drivers

;;
;; Default install sections
;;

[DefaultInstall]
OptionDesc          = %ServiceDesc%
CopyFiles           = DRBD.DriverFiles

[DefaultInstall.Services]
AddService          = %ServiceName%,,DRBD.Service

;;
;; Default uninstall sections
;;

[DefaultUninstall]
DelFiles            = DRBD.DriverFiles
DelReg              = DRBD.DelRegistry

[DefaultUninstall.Services]
DelService = WinDRBD

;
; Services Section
;

[DRBD.Service]
DisplayName      = %ServiceName%
Description      = %ServiceDesc%
ServiceBinary    = %12%\windrbd.sys     	;%windir%\system32\drivers\windrbd.sys
ServiceType      = 1                    ;SERVICE_FILE_SYSTEM_DRIVER
StartType        = 3
ErrorControl     = 0                    ;SERVICE_ERROR_NORMAL
AddReg           = DRBD.AddRegistry

;
; Registry Modifications (will soon go away)
;

[DRBD.AddRegistry]
HKR,,"syslog_ip",0x00000002, "127.0.0.1"

[DRBD.DelRegistry]
HKR,,"syslog_ip"

;
; Copy Files
;

[DRBD.DriverFiles]
windrbd.sys

[SourceDisksFiles]
windrbd.sys = 1,,

[SourceDisksNames]
1 = %DiskId1%,,,

;;
;; String Section
;;

[Strings]
ServiceDesc         = "WinDRBD - storage replication over network for Microsoft Windows"
;; this is the parameter to sc (e.g. sc start windrbd to start the driver)
ServiceName         = "WinDRBD"
DiskId1             = "WinDRBD Installation Disk"

